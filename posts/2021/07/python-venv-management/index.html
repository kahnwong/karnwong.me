<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Python venv management | Karn Wong</title><meta name=keywords content="python"><meta name=description content="When you create a project in python, you should create requirements.txt to specify dependencies, so other people can have the same environment when using your project.
However, if you don’t specify module versions in requirements.txt, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.
Another issue is that maybe you’re working on a few python projects, each uses different python versions (eg."><meta name=author content="Karn Wong"><link rel=canonical href=https://www.karnwong.me/posts/2021/07/python-venv-management/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.karnwong.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.karnwong.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.karnwong.me/favicon-32x32.png><link rel=apple-touch-icon href=https://www.karnwong.me/apple-touch-icon.png><link rel=mask-icon href=https://www.karnwong.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-8CYMFC0KZ9"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8CYMFC0KZ9",{anonymize_ip:!1})}</script><meta property="og:title" content="Python venv management"><meta property="og:description" content="When you create a project in python, you should create requirements.txt to specify dependencies, so other people can have the same environment when using your project.
However, if you don’t specify module versions in requirements.txt, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.
Another issue is that maybe you’re working on a few python projects, each uses different python versions (eg."><meta property="og:type" content="article"><meta property="og:url" content="https://www.karnwong.me/posts/2021/07/python-venv-management/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-02T14:59:12+07:00"><meta property="article:modified_time" content="2021-07-02T14:59:12+07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python venv management"><meta name=twitter:description content="When you create a project in python, you should create requirements.txt to specify dependencies, so other people can have the same environment when using your project.
However, if you don’t specify module versions in requirements.txt, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.
Another issue is that maybe you’re working on a few python projects, each uses different python versions (eg."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.karnwong.me/posts/"},{"@type":"ListItem","position":2,"name":"Python venv management","item":"https://www.karnwong.me/posts/2021/07/python-venv-management/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Python venv management","name":"Python venv management","description":"When you create a project in python, you should create requirements.txt to specify dependencies, so other people can have the same environment when using your project.\nHowever, if you don’t specify module versions in requirements.txt, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.\nAnother issue is that maybe you’re working on a few python projects, each uses different python versions (eg.","keywords":["python"],"articleBody":"When you create a project in python, you should create requirements.txt to specify dependencies, so other people can have the same environment when using your project.\nHowever, if you don’t specify module versions in requirements.txt, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.\nAnother issue is that maybe you’re working on a few python projects, each uses different python versions (eg. projectA uses python3.6, projectB uses python3.9, etc).\nEnters pyenv and pipenv (I will discuss about poetry later), where you can easily switch python versions, and have different environment (with python version locking) for projects you’re working on.\nInstalling pyenv Follow instructions here. For windows, use this.\nUseful commands # list available python versions pyenv install --list # install specific version pyenv install 3.8.0 # list installed versions pyenv versions # activate new env pyenv shell 3.8.0 # support multiple version # config venv pyenv virtualenv 3.8.0 my-data-project # set env per folder/project pyenv local my-data-project Installing pipenv Notes: make sure pyenv is installed, and remove anaconda / miconda \u0026 python3 installed via official installer from your system. Then run:\n$ pip install pipenv # run this command every time pip installs a .exe $ pyenv rehash pipenv workflow pipenv --python 3.7 # install a specific module pipenv install jupyterlab==2.2.9 # install from existing requirements.txt or from Pipfile definition pipenv install # remove venv pipenv --rm # running inside venv pipenv run jupyter lab pipenv run python main.py # is equivalent to `pipenv shell \u0026\u0026 python3 main.py` Windows only $ pyenv install 3.7.7 # see Pipfile for required python version $ pyenv local 3.7.7 # IMPORTANT. global / shell doesn't work with pipenv $ pyenv rehash $ pip install pipenv # done once per pyenv python version $ pyenv rehash $ pipenv --python 3.7 $ pipenv install $ pipenv run python tokenization_sandbox.py Notes On linux/mac, do not use system python. OS updates would mean python version upgrade, in turn making all your installed modules gone. Use python installed via pyenv instead. On windows, start fresh with pyenv. Do not use anaconda distribution. It does too much background magic that can make things harder to manage environment property. In addition, venv definition from anaconda is often doesn’t work cross-platform (eg. venv def from windows wouldn’t work on mac due to different wheel binary versions). Always create venv via pipenv per each project. Although you can have a playground venv via pyenv, so you can shell into it and do a quick analysis / scripting on an adhoc basis. I heard good things about poetry but it doesn’t integrate with pyenv natively. It would work if you use it to publish python modules, since it simplifies a lot of processes. poetry also picks up the wrong python version from pyenv. And if you sync python version via pyenv, it has to be the same python version across all OSes, including minor version. pipenv doesn’t have this restriction, and it also picks up the correct python version from pyenv by default (via pipenv --python 3.8). ","wordCount":"518","inLanguage":"en","datePublished":"2021-07-02T14:59:12+07:00","dateModified":"2021-07-02T14:59:12+07:00","author":{"@type":"Person","name":"Karn Wong"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.karnwong.me/posts/2021/07/python-venv-management/"},"publisher":{"@type":"Organization","name":"Karn Wong","logo":{"@type":"ImageObject","url":"https://www.karnwong.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.karnwong.me/ accesskey=h title="Karn Wong (Alt + H)">Karn Wong</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.karnwong.me/about/ title=About><span>About</span></a></li><li><a href=https://www.karnwong.me/posts title=Posts><span>Posts</span></a></li><li><a href=https://www.karnwong.me/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.karnwong.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.karnwong.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.karnwong.me/>Home</a>&nbsp;»&nbsp;<a href=https://www.karnwong.me/posts/>Posts</a></div><h1 class=post-title>Python venv management</h1><div class=post-meta><span title='2021-07-02 14:59:12 +0700 +07'>July 2, 2021</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Karn Wong</div></header><div class=post-content><p>When you create a project in python, you should create <code>requirements.txt</code> to specify dependencies, so other people can have the same environment when using your project.</p><p>However, if you don’t specify module versions in <code>requirements.txt</code>, you could end up with people using the wrong module version, where some APIs can be deprecated or have different behaviors than older versions.</p><p>Another issue is that maybe you’re working on a few python projects, each uses different python versions (eg. projectA uses python3.6, projectB uses python3.9, etc).</p><p>Enters <code>pyenv</code> and <code>pipenv</code> (I will discuss about <code>poetry</code> later), where you can easily switch python versions, and have different environment (with python version locking) for projects you’re working on.</p><h1 id=installing-pyenv>Installing pyenv<a hidden class=anchor aria-hidden=true href=#installing-pyenv>#</a></h1><p>Follow instructions <a href=https://github.com/pyenv/pyenv>here</a>. For windows, use <a href=https://github.com/pyenv-win/pyenv-win>this</a>.</p><h2 id=useful-commands>Useful commands<a hidden class=anchor aria-hidden=true href=#useful-commands>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># list available python versions</span>
</span></span><span style=display:flex><span>pyenv install --list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install specific version</span>
</span></span><span style=display:flex><span>pyenv install 3.8.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># list installed versions</span>
</span></span><span style=display:flex><span>pyenv versions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># activate new env</span>
</span></span><span style=display:flex><span>pyenv shell 3.8.0 <span style=color:#75715e># support multiple version</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># config venv</span>
</span></span><span style=display:flex><span>pyenv virtualenv 3.8.0 my-data-project
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set env per folder/project</span>
</span></span><span style=display:flex><span>pyenv local my-data-project
</span></span></code></pre></div><h1 id=installing-pipenvhttpsgithubcompypapipenv>Installing <a href=https://github.com/pypa/pipenv>pipenv</a><a hidden class=anchor aria-hidden=true href=#installing-pipenvhttpsgithubcompypapipenv>#</a></h1><p>Notes: make sure <code>pyenv</code> is installed, and remove <code>anaconda / miconda</code> & <code>python3</code> installed via official installer from your system. Then run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pip install pipenv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># run this command every time pip installs a .exe</span>
</span></span><span style=display:flex><span>$ pyenv rehash
</span></span></code></pre></div><h2 id=pipenv-workflow>pipenv workflow<a hidden class=anchor aria-hidden=true href=#pipenv-workflow>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pipenv --python 3.7
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install a specific module</span>
</span></span><span style=display:flex><span>pipenv install jupyterlab<span style=color:#f92672>==</span>2.2.9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install from existing requirements.txt or from Pipfile definition</span>
</span></span><span style=display:flex><span>pipenv install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># remove venv</span>
</span></span><span style=display:flex><span>pipenv --rm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># running inside venv</span>
</span></span><span style=display:flex><span>pipenv run jupyter lab
</span></span><span style=display:flex><span>pipenv run python main.py <span style=color:#75715e># is equivalent to `pipenv shell &amp;&amp; python3 main.py`</span>
</span></span></code></pre></div><h2 id=windows-only>Windows only<a hidden class=anchor aria-hidden=true href=#windows-only>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pyenv install 3.7.7 <span style=color:#75715e># see Pipfile for required python version</span>
</span></span><span style=display:flex><span>$ pyenv local 3.7.7 <span style=color:#75715e># IMPORTANT. global / shell doesn&#39;t work with pipenv</span>
</span></span><span style=display:flex><span>$ pyenv rehash
</span></span><span style=display:flex><span>$ pip install pipenv <span style=color:#75715e># done once per pyenv python version</span>
</span></span><span style=display:flex><span>$ pyenv rehash
</span></span><span style=display:flex><span>$ pipenv --python 3.7
</span></span><span style=display:flex><span>$ pipenv install
</span></span><span style=display:flex><span>$ pipenv run python tokenization_sandbox.py
</span></span></code></pre></div><h1 id=notes>Notes<a hidden class=anchor aria-hidden=true href=#notes>#</a></h1><ul><li>On linux/mac, do not use system python. OS updates would mean python version upgrade, in turn making all your installed modules gone. Use python installed via pyenv instead.</li><li>On windows, start fresh with pyenv.</li><li>Do not use anaconda distribution. It does too much background magic that can make things harder to manage environment property. In addition, venv definition from anaconda is often doesn’t work cross-platform (eg. venv def from windows wouldn’t work on mac due to different wheel binary versions).</li><li>Always create venv via pipenv per each project. Although you can have a playground venv via pyenv, so you can shell into it and do a quick analysis / scripting on an adhoc basis.</li><li>I heard good things about <a href=https://github.com/python-poetry/poetry>poetry</a> but it doesn’t integrate with <code>pyenv</code> natively. It would work if you use it to publish python modules, since it simplifies a lot of processes.<ul><li>poetry also picks up the wrong python version from pyenv. And if you sync python version via pyenv, it has to be the same python version across all OSes, including minor version. pipenv doesn’t have this restriction, and it also picks up the correct python version from pyenv by default (via <code>pipenv --python 3.8</code>).</li></ul></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.karnwong.me/tags/python/>python</a></li></ul><nav class=paginav><a class=prev href=https://www.karnwong.me/posts/2021/08/self-hosting-primer/><span class=title>« Prev</span><br><span>Self-hosting primer</span></a>
<a class=next href=https://www.karnwong.me/posts/2021/06/dont-write-large-table-to-postgres-with-pandas/><span class=title>Next »</span><br><span>Don't write large table to postgres with pandas</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.karnwong.me/>Karn Wong</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>