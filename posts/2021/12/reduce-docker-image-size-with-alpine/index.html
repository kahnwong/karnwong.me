<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reduce docker image size with alpine | Karn Wong</title><meta name=keywords content="devops,docker"><meta name=description content="Creating scripts are easy. But creating a small docker image is not ðŸ˜….
Not all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.
A simple bash script docker image Given a Dockerfile (change apk to apt for ubuntu):
FROM alpine:3 WORKDIR /app RUN apk update && apk add jq curl COPY water-cut-notify.sh ./ ENTRYPOINT [&#34;sh&#34;, &#34;/app/water-cut-notify."><meta name=author content="Karn Wong"><link rel=canonical href=https://www.karnwong.me/posts/2021/12/reduce-docker-image-size-with-alpine/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.karnwong.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.karnwong.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.karnwong.me/favicon-32x32.png><link rel=apple-touch-icon href=https://www.karnwong.me/apple-touch-icon.png><link rel=mask-icon href=https://www.karnwong.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-8CYMFC0KZ9"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8CYMFC0KZ9",{anonymize_ip:!1})}</script><meta property="og:title" content="Reduce docker image size with alpine"><meta property="og:description" content="Creating scripts are easy. But creating a small docker image is not ðŸ˜….
Not all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.
A simple bash script docker image Given a Dockerfile (change apk to apt for ubuntu):
FROM alpine:3 WORKDIR /app RUN apk update && apk add jq curl COPY water-cut-notify.sh ./ ENTRYPOINT [&#34;sh&#34;, &#34;/app/water-cut-notify."><meta property="og:type" content="article"><meta property="og:url" content="https://www.karnwong.me/posts/2021/12/reduce-docker-image-size-with-alpine/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-19T20:50:07+07:00"><meta property="article:modified_time" content="2021-12-19T20:50:07+07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Reduce docker image size with alpine"><meta name=twitter:description content="Creating scripts are easy. But creating a small docker image is not ðŸ˜….
Not all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.
A simple bash script docker image Given a Dockerfile (change apk to apt for ubuntu):
FROM alpine:3 WORKDIR /app RUN apk update && apk add jq curl COPY water-cut-notify.sh ./ ENTRYPOINT [&#34;sh&#34;, &#34;/app/water-cut-notify."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.karnwong.me/posts/"},{"@type":"ListItem","position":2,"name":"Reduce docker image size with alpine","item":"https://www.karnwong.me/posts/2021/12/reduce-docker-image-size-with-alpine/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reduce docker image size with alpine","name":"Reduce docker image size with alpine","description":"Creating scripts are easy. But creating a small docker image is not ðŸ˜….\nNot all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.\nA simple bash script docker image Given a Dockerfile (change apk to apt for ubuntu):\nFROM alpine:3 WORKDIR /app RUN apk update \u0026amp;\u0026amp; apk add jq curl COPY water-cut-notify.sh ./ ENTRYPOINT [\u0026#34;sh\u0026#34;, \u0026#34;/app/water-cut-notify.","keywords":["devops","docker"],"articleBody":"Creating scripts are easy. But creating a small docker image is not ðŸ˜….\nNot all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.\nA simple bash script docker image Given a Dockerfile (change apk to apt for ubuntu):\nFROM alpine:3 WORKDIR /app RUN apk update \u0026\u0026 apk add jq curl COPY water-cut-notify.sh ./ ENTRYPOINT [\"sh\", \"/app/water-cut-notify.sh\"] Base image Docker image size alpine 11.1MB ubuntu 122MB Ubuntu image size is 1099% larger!!!!!!\nWhat about a light python image? FROM python:3.9-alpine WORKDIR /app RUN pip install requests Base image Docker image size alpine 53.6MB ubuntu 920MB Ubuntu image size is 1716% larger!!!!!!\nShould you use alpine image for everything? From above two experiments, we get:\nItâ€™s obvious that alpine has a very significant lighter footprint than ubuntu. But donâ€™t use alpine image for everything. For bash and go, using alpine results in lighter footprint. But for python apps, itâ€™s better to go with debian-based images. This article explains in details why itâ€™s so.\n","wordCount":"178","inLanguage":"en","datePublished":"2021-12-19T20:50:07+07:00","dateModified":"2021-12-19T20:50:07+07:00","author":{"@type":"Person","name":"Karn Wong"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.karnwong.me/posts/2021/12/reduce-docker-image-size-with-alpine/"},"publisher":{"@type":"Organization","name":"Karn Wong","logo":{"@type":"ImageObject","url":"https://www.karnwong.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.karnwong.me/ accesskey=h title="Karn Wong (Alt + H)">Karn Wong</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.karnwong.me/about/ title=About><span>About</span></a></li><li><a href=https://www.karnwong.me/posts title=Posts><span>Posts</span></a></li><li><a href=https://www.karnwong.me/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.karnwong.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.karnwong.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.karnwong.me/>Home</a>&nbsp;Â»&nbsp;<a href=https://www.karnwong.me/posts/>Posts</a></div><h1 class=post-title>Reduce docker image size with alpine</h1><div class=post-meta><span title='2021-12-19 20:50:07 +0700 +07'>December 19, 2021</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Karn Wong</div></header><div class=post-content><p>Creating scripts are easy. But creating a small docker image is not ðŸ˜….</p><p>Not all Linux flavors are created equal, some are bigger than others, etc. But this difference is very crucial when it comes to reducing docker image size.</p><h2 id=a-simple-bash-script-docker-image>A simple bash script docker image<a hidden class=anchor aria-hidden=true href=#a-simple-bash-script-docker-image>#</a></h2><p>Given a Dockerfile (change <code>apk</code> to <code>apt</code> for <code>ubuntu</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> alpine:3</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apk update <span style=color:#f92672>&amp;&amp;</span> apk add jq curl<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> water-cut-notify.sh ./<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENTRYPOINT</span> [<span style=color:#e6db74>&#34;sh&#34;</span>, <span style=color:#e6db74>&#34;/app/water-cut-notify.sh&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><table><thead><tr><th>Base image</th><th>Docker image size</th></tr></thead><tbody><tr><td>alpine</td><td>11.1MB</td></tr><tr><td>ubuntu</td><td>122MB</td></tr></tbody></table><p>Ubuntu image size is <code>1099%</code> larger!!!!!!</p><h2 id=what-about-a-light-python-image>What about a light python image?<a hidden class=anchor aria-hidden=true href=#what-about-a-light-python-image>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> python:3.9-alpine</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> pip install requests<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><table><thead><tr><th>Base image</th><th>Docker image size</th></tr></thead><tbody><tr><td>alpine</td><td>53.6MB</td></tr><tr><td>ubuntu</td><td>920MB</td></tr></tbody></table><p>Ubuntu image size is <code>1716%</code> larger!!!!!!</p><h2 id=should-you-use-alpine-image-for-everything>Should you use alpine image for everything?<a hidden class=anchor aria-hidden=true href=#should-you-use-alpine-image-for-everything>#</a></h2><p>From above two experiments, we get:</p><p><img loading=lazy src=/images/2021-12-19-21-21-35.png alt></p><p>It&rsquo;s obvious that alpine has a very significant lighter footprint than ubuntu. But don&rsquo;t use alpine image for everything. For bash and go, using alpine results in lighter footprint. But for python apps, it&rsquo;s better to go with debian-based images. This <a href=https://pythonspeed.com/articles/alpine-docker-python/>article</a> explains in details why it&rsquo;s so.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.karnwong.me/tags/devops/>devops</a></li><li><a href=https://www.karnwong.me/tags/docker/>docker</a></li></ul><nav class=paginav><a class=prev href=https://www.karnwong.me/posts/2021/12/use-pyspark-locally-with-docker/><span class=title>Â« Prev</span><br><span>Use pyspark locally with docker</span></a>
<a class=next href=https://www.karnwong.me/posts/2021/11/secrets-management-with-sops-aws-ssm-terraform/><span class=title>Next Â»</span><br><span>Secrets management with SOPS, AWS SSM and Terraform</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.karnwong.me/>Karn Wong</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>