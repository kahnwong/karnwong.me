<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What SQL can't do for data engineering | Karn Wong</title><meta name=keywords content="data engineering"><meta name=description content="I often hear people ask &ldquo;if you can do data engineering with SQL, then what&rsquo;s the point of learning spark or python?&rdquo;
Data ingestion Let&rsquo;s circle back at bit.
I think we all can agree that: there&rsquo;s a point in time where there&rsquo;s no data in the data warehouse (which DE-who-use-SQL&rsquo;s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can&rsquo;t use SQL to do stuff with the data."><meta name=author content="Karn Wong"><link rel=canonical href=https://www.karnwong.me/posts/2022/05/what-sql-cant-do-for-data-engineering/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.karnwong.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.karnwong.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.karnwong.me/favicon-32x32.png><link rel=apple-touch-icon href=https://www.karnwong.me/apple-touch-icon.png><link rel=mask-icon href=https://www.karnwong.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-8CYMFC0KZ9"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8CYMFC0KZ9",{anonymize_ip:!1})}</script><meta property="og:title" content="What SQL can't do for data engineering"><meta property="og:description" content="I often hear people ask &ldquo;if you can do data engineering with SQL, then what&rsquo;s the point of learning spark or python?&rdquo;
Data ingestion Let&rsquo;s circle back at bit.
I think we all can agree that: there&rsquo;s a point in time where there&rsquo;s no data in the data warehouse (which DE-who-use-SQL&rsquo;s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can&rsquo;t use SQL to do stuff with the data."><meta property="og:type" content="article"><meta property="og:url" content="https://www.karnwong.me/posts/2022/05/what-sql-cant-do-for-data-engineering/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-15T22:38:45+07:00"><meta property="article:modified_time" content="2022-05-15T22:38:45+07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="What SQL can't do for data engineering"><meta name=twitter:description content="I often hear people ask &ldquo;if you can do data engineering with SQL, then what&rsquo;s the point of learning spark or python?&rdquo;
Data ingestion Let&rsquo;s circle back at bit.
I think we all can agree that: there&rsquo;s a point in time where there&rsquo;s no data in the data warehouse (which DE-who-use-SQL&rsquo;s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can&rsquo;t use SQL to do stuff with the data."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.karnwong.me/posts/"},{"@type":"ListItem","position":2,"name":"What SQL can't do for data engineering","item":"https://www.karnwong.me/posts/2022/05/what-sql-cant-do-for-data-engineering/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What SQL can't do for data engineering","name":"What SQL can\u0027t do for data engineering","description":"I often hear people ask \u0026ldquo;if you can do data engineering with SQL, then what\u0026rsquo;s the point of learning spark or python?\u0026rdquo;\nData ingestion Let\u0026rsquo;s circle back at bit.\nI think we all can agree that: there\u0026rsquo;s a point in time where there\u0026rsquo;s no data in the data warehouse (which DE-who-use-SQL\u0026rsquo;s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can\u0026rsquo;t use SQL to do stuff with the data.","keywords":["data engineering"],"articleBody":"I often hear people ask “if you can do data engineering with SQL, then what’s the point of learning spark or python?”\nData ingestion Let’s circle back at bit.\nI think we all can agree that: there’s a point in time where there’s no data in the data warehouse (which DE-who-use-SQL’s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can’t use SQL to do stuff with the data.\nSo who put the data into the data warehouse? Data engineers of course! But not the kind that use SQL. These data engineers are known as “data platform engineers,” where their main focus is data ingestion, platform and scalability.\nThe confusion lies in the fact that, there seems to be different tools and skills required for platform or analytics type for data engineers, but some places still refer to both roles as data engineer.\nAnd guess how data platform engineers write large amount of data to data warehouse. With help of spark and python/java of course!\nData cleaning What if you need to perform complex data cleaning processes for your data? You might have to create multiple temp columns, then coalesce them at the end to get the final result. You can do this in SQL, with the help of jinja template, to certain extent. But the same process expressed in python would be much more concise and readable. Especially if it in involves multiple steps spanning 700 lines of code. Not to mention you might need to perform debugging somewhere in between, and setting up SQL debugging is not something I wish on my worst enemy.\nSome people say “but you can also create functions in SQL.” Yes, you can, but it’s clunky and very fragile, and not very readable.\nOptimization When you’re writing SQL for data transformation, the actual execution logic is being translated by the database’s engine. As with all forms of translations, some information is lost, and can result in non-optimized instructions. For instance, if you need to perform longest matching against a list of string, one way to optimize this is to set a break condition after you found a match. In SQL, this most likely results in instructions to compare every string from the list, instead of stopping the matching process and move onto the next operation after a match is found.\nThese are some but not all instances where SQL falls short for data engineering tasks. I hope this article sheds some light on the importance of using python/spark for data engineering tasks.\n","wordCount":"433","inLanguage":"en","datePublished":"2022-05-15T22:38:45+07:00","dateModified":"2022-05-15T22:38:45+07:00","author":{"@type":"Person","name":"Karn Wong"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.karnwong.me/posts/2022/05/what-sql-cant-do-for-data-engineering/"},"publisher":{"@type":"Organization","name":"Karn Wong","logo":{"@type":"ImageObject","url":"https://www.karnwong.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.karnwong.me/ accesskey=h title="Karn Wong (Alt + H)">Karn Wong</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.karnwong.me/about/ title=About><span>About</span></a></li><li><a href=https://www.karnwong.me/posts title=Posts><span>Posts</span></a></li><li><a href=https://www.karnwong.me/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.karnwong.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.karnwong.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.karnwong.me/>Home</a>&nbsp;»&nbsp;<a href=https://www.karnwong.me/posts/>Posts</a></div><h1 class=post-title>What SQL can't do for data engineering</h1><div class=post-meta><span title='2022-05-15 22:38:45 +0700 +07'>May 15, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Karn Wong</div></header><div class=post-content><p>I often hear people ask &ldquo;if you can do data engineering with SQL, then what&rsquo;s the point of learning spark or python?&rdquo;</p><h2 id=data-ingestion>Data ingestion<a hidden class=anchor aria-hidden=true href=#data-ingestion>#</a></h2><p>Let&rsquo;s circle back at bit.</p><p>I think we all can agree that: there&rsquo;s a point in time where there&rsquo;s no data in the data warehouse (which DE-who-use-SQL&rsquo;s use as base of operation). The source data could be anything from hard CSV/Excel or API endpoints. No data in data warehouse, DE can&rsquo;t use SQL to do stuff with the data.</p><p>So who put the data into the data warehouse? Data engineers of course! But not the kind that use SQL. These data engineers are known as &ldquo;data <em>platform</em> engineers,&rdquo; where their main focus is data ingestion, platform and scalability.</p><p>The confusion lies in the fact that, there seems to be different tools and skills required for platform or analytics type for data engineers, but some places still refer to both roles as data engineer.</p><p>And guess how data platform engineers write large amount of data to data warehouse. With help of spark and python/java of course!</p><h2 id=data-cleaning>Data cleaning<a hidden class=anchor aria-hidden=true href=#data-cleaning>#</a></h2><p>What if you need to perform complex data cleaning processes for your data? You might have to create multiple temp columns, then coalesce them at the end to get the final result. You can do this in SQL, with the help of jinja template, to certain extent. But the same process expressed in python would be much more concise and readable. Especially if it in involves multiple steps spanning 700 lines of code. Not to mention you might need to perform debugging somewhere in between, and setting up SQL debugging is not something I wish on my worst enemy.</p><p>Some people say &ldquo;but you can also create functions in SQL.&rdquo; Yes, you can, but it&rsquo;s clunky and very fragile, and not very readable.</p><h2 id=optimization>Optimization<a hidden class=anchor aria-hidden=true href=#optimization>#</a></h2><p>When you&rsquo;re writing SQL for data transformation, the actual execution logic is being translated by the database&rsquo;s engine. As with all forms of translations, some information is lost, and can result in non-optimized instructions. For instance, if you need to perform longest matching against a list of string, one way to optimize this is to set a <code>break</code> condition after you found a match. In SQL, this most likely results in instructions to compare every string from the list, instead of stopping the matching process and move onto the next operation after a match is found.</p><hr><p>These are some but not all instances where SQL falls short for data engineering tasks. I hope this article sheds some light on the importance of using python/spark for data engineering tasks.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.karnwong.me/tags/data-engineering/>data engineering</a></li></ul><nav class=paginav><a class=prev href=https://www.karnwong.me/posts/2022/08/data-engineer-archtypes/><span class=title>« Prev</span><br><span>Data engineer archtypes</span></a>
<a class=next href=https://www.karnwong.me/posts/2022/02/use-ssh-key-during-docker-build-without-embedding-the-key-via-ssh-agent/><span class=title>Next »</span><br><span>Use SSH key during docker build without embedding the key via ssh-agent</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.karnwong.me/>Karn Wong</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>